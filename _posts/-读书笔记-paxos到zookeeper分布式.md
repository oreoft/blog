---
layout: post
title:   
excerpt:  
category: 
keywords: 
---

## 前言



## 笔记

### 分布式架构基础

- 原来大家都使用集中式架构，这个缺点也很明显，首先需要非常强大的大型主机，运维成本也非常高。最主要的是随着业务的不断发展，用单一大型主机进行系统扩容非常困难，单节点无法支撑井喷式的业务，尤其是一旦一台大型主机出现了故障，那么整个系统会处于不可用的状态后果非常严重
- 现在流行的分布式，当然有有点也有缺点，优点就是对空间分布要求比较低可以不受空间的限制，扩展性也非常强可以使用副本机制提供数据的冗余，缺点非常依赖网络通信，每个结点都有可能出现故障，并且每天都在发生
- ACID到CAP、BASE
  - ACID事务的四个特征这里就不详细说明了，书上说的很详细，但是对于八股文程序员来说这个应该是再熟悉不过了
  - 原来单机的事务模型已经无法胜任，因为如果要保证ACID的话，分布式系统的可用性和严格一致性就会出现冲突。所以在分布式提出一个新的理论CAP， CAP理论告诉我们，一个分布式系统不能同时满足这三个基本需求，最多只能同时满足其中的两项
    - C：一致性，是指数据在多个副本之间是否能保证一致的特性，里面又详细分为强一致和弱一致。
    - A: 可用性， 是指系统提供的服务必须一致处于可用的，不能处于宕机或者超时状态
    - P: 分区容错性， 分区容错是指加入一个分区出现故障应该依然可以对我提供满足一致性和可用性的服务，除非整个集群都挂掉了。这个是什么意思呢，相当于是冗余备份，abc三个分区里面都存有互相的数据，假如c挂掉了，ab里面依然有c的数据，依然可以对外提供数据一致的服务。
  - 上面说CAP只能同时满足两项， 大部分我们需要平衡的都是CA之间，因为对于分布式系统而言，网络问题是一个必定会出现的异常情况，所以如果想要高可用，P是必须要面对的问题，必然需要进行分区容错。
  - BASE是基于CAP逐步演化而来的，其核心思想是即使无法做到强一致性，也应该根据每个业务的自身特点做到最终一致性（属于弱一致性）。
    - BA：基本可用，允许损失部分可用性或者增加可接受范围内rt时间
    - S:  软状态，允许系统在数据副本之间数据的同步存在延时，短暂数据不一致
    - E:  最终一致性， 经过一段时间的同步后，数据最终需要达到一致的状态
  - 最终一致性大概是什么样子呢，就像是你在淘宝买东西，你看库存还有10个，当你赶紧去下单，然后系统提示下单失败库存不够，你可能会抱怨自己搜素不够快，但是如果你参与过电商项目你应该会知道，这应该是前台缓存不一致导致的，实际数据库的库存应该已经是0了，但是前台缓存数据没同步，当你下单的时候（最终状态）发现是没有库存的，这个时候缓存也会进行更新。



